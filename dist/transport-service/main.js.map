{"version":3,"file":"main.js","mappings":"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","sources":["external commonjs \"tslib\"","external commonjs \"@nestjs/core\"","external commonjs \"@nestjs/common\"","external commonjs \"@nestjs/config\"","external commonjs \"@prisma/client\"","C:\\Users\\USER1\\going-monorepo-clean\\libs\\shared\\prisma-client\\src\\lib\\prisma.service.ts","C:\\Users\\USER1\\going-monorepo-clean\\libs\\shared\\prisma-client\\src\\lib\\prisma.module.ts","C:\\Users\\USER1\\going-monorepo-clean\\libs\\shared\\prisma-client\\src\\index.ts","C:\\Users\\USER1\\going-monorepo-clean\\libs\\domains\\transport\\core\\src\\libs\\entities\\trip.entity.ts","C:\\Users\\USER1\\going-monorepo-clean\\libs\\domains\\transport\\core\\src\\libs\\ports\\itrip.repository.ts","C:\\Users\\USER1\\going-monorepo-clean\\libs\\domains\\transport\\core\\src\\index.ts","C:\\Users\\USER1\\going-monorepo-clean\\transport-service\\src\\infrastructure\\persistence\\prisma-transport.repository.ts","C:\\Users\\USER1\\going-monorepo-clean\\transport-service\\src\\infrastructure\\infrastructure.module.ts","external commonjs \"class-transformer\"","external commonjs \"class-validator\"","C:\\Users\\USER1\\going-monorepo-clean\\libs\\domains\\transport\\application\\src\\lib\\dto\\request-trip.dto.ts","C:\\Users\\USER1\\going-monorepo-clean\\libs\\domains\\transport\\application\\src\\lib\\use-cases\\request-trip.use-case.ts","C:\\Users\\USER1\\going-monorepo-clean\\libs\\domains\\transport\\application\\src\\lib\\use-cases\\accept-trip.use-case.ts","C:\\Users\\USER1\\going-monorepo-clean\\libs\\domains\\transport\\application\\src\\lib\\transport-application.module.ts","C:\\Users\\USER1\\going-monorepo-clean\\libs\\domains\\transport\\application\\src\\index.ts","C:\\Users\\USER1\\going-monorepo-clean\\transport-service\\src\\api\\transport.controller.ts","C:\\Users\\USER1\\going-monorepo-clean\\transport-service\\src\\app.module.ts","C:\\Users\\USER1\\going-monorepo-clean\\transport-service\\src\\main.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = require(\"tslib\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@nestjs/core\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@nestjs/common\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@nestjs/config\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@prisma/client\");","import { Injectable, OnModuleInit, OnModuleDestroy, Logger } from '@nestjs/common';\r\nimport { PrismaClient } from '@prisma/client';\r\n\r\n@Injectable()\r\nexport class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {\r\n  private readonly logger = new Logger(PrismaService.name);\r\n\r\n  constructor() {\r\n    super({\r\n      log: process.env.NODE_ENV === 'development' \r\n        ? ['query', 'info', 'warn', 'error'] \r\n        : ['error'],\r\n    });\r\n  }\r\n\r\n  async onModuleInit() {\r\n    try {\r\n      await this.$connect();\r\n      this.logger.log('Connected to PostgreSQL database');\r\n    } catch (error) {\r\n      this.logger.error('Failed to connect to PostgreSQL database', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async onModuleDestroy() {\r\n    await this.$disconnect();\r\n    this.logger.log('Disconnected from PostgreSQL database');\r\n  }\r\n\r\n  /**\r\n   * Execute operations within a transaction\r\n   * All operations succeed or all fail together\r\n   */\r\n  async executeTransaction<T>(\r\n    fn: (tx: Omit<PrismaClient, '$connect' | '$disconnect' | '$on' | '$transaction' | '$use'>) => Promise<T>,\r\n  ): Promise<T> {\r\n    return this.$transaction(fn);\r\n  }\r\n\r\n  /**\r\n   * Clean database for testing purposes\r\n   * WARNING: This deletes all data!\r\n   */\r\n  async cleanDatabase() {\r\n    if (process.env.NODE_ENV !== 'test') {\r\n      throw new Error('cleanDatabase can only be used in test environment');\r\n    }\r\n    \r\n    const tablenames = await this.$queryRaw<Array<{ tablename: string }>>`\r\n      SELECT tablename FROM pg_tables WHERE schemaname='public'\r\n    `;\r\n\r\n    for (const { tablename } of tablenames) {\r\n      if (tablename !== '_prisma_migrations') {\r\n        await this.$executeRawUnsafe(`TRUNCATE TABLE \"public\".\"${tablename}\" CASCADE;`);\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { Global, Module } from '@nestjs/common';\r\nimport { PrismaService } from './prisma.service';\r\n\r\n@Global()\r\n@Module({\r\n  providers: [PrismaService],\r\n  exports: [PrismaService],\r\n})\r\nexport class PrismaModule {}\r\n","// Prisma Client re-exports\r\nexport * from '@prisma/client';\r\n\r\n// NestJS integration\r\nexport { PrismaService } from './lib/prisma.service';\r\nexport { PrismaModule } from './lib/prisma.module';\r\n","import { Location, Money } from '@going-monorepo-clean/shared-domain';\r\n\r\nexport type TripStatus = 'SCHEDULED' | 'WAITING_PASSENGERS' | 'IN_TRANSIT' | 'COMPLETED' | 'CANCELLED';\r\nexport type VehicleType = 'SUV' | 'VAN';\r\nexport type TravelMode = 'DOOR_TO_DOOR' | 'POINT_TO_POINT';\r\n\r\n// Passenger in a shared trip\r\ninterface TripPassenger {\r\n  userId: string;\r\n  originCity: string;\r\n  originAddress: string;\r\n  destCity: string;\r\n  destAddress: string;\r\n  pricePaid: number;\r\n  currency: string;\r\n  frontSeat: boolean; // Only for SUV\r\n}\r\n\r\nexport interface TripProps {\r\n  id: string;\r\n  driverId: string;\r\n  vehicleType: VehicleType;\r\n  mode: TravelMode;\r\n  status: TripStatus;\r\n  passengers: TripPassenger[];\r\n  originCity: string;\r\n  originAddress: string;\r\n  destCity: string;\r\n  destAddress: string;\r\n  stationOrigin?: string; // For VAN only\r\n  stationDest?: string; // For VAN only\r\n  departureTime: Date;\r\n  estimatedArrivalTime: Date;\r\n  basePrice: number;\r\n  pricePerPassenger: number;\r\n  currency: string;\r\n  createdAt: Date;\r\n}\r\n\r\nexport class Trip {\r\n  id: string;\r\n  driverId: string;\r\n  vehicleType: VehicleType;\r\n  mode: TravelMode;\r\n  status: TripStatus;\r\n  passengers: TripPassenger[];\r\n  originCity: string;\r\n  originAddress: string;\r\n  destCity: string;\r\n  destAddress: string;\r\n  stationOrigin?: string;\r\n  stationDest?: string;\r\n  departureTime: Date;\r\n  estimatedArrivalTime: Date;\r\n  basePrice: number;\r\n  pricePerPassenger: number;\r\n  currency: string;\r\n  readonly createdAt: Date;\r\n\r\n  private constructor(props: TripProps) {\r\n    this.id = props.id;\r\n    this.driverId = props.driverId;\r\n    this.vehicleType = props.vehicleType;\r\n    this.mode = props.mode;\r\n    this.status = props.status;\r\n    this.passengers = props.passengers;\r\n    this.originCity = props.originCity;\r\n    this.originAddress = props.originAddress;\r\n    this.destCity = props.destCity;\r\n    this.destAddress = props.destAddress;\r\n    this.stationOrigin = props.stationOrigin;\r\n    this.stationDest = props.stationDest;\r\n    this.departureTime = props.departureTime;\r\n    this.estimatedArrivalTime = props.estimatedArrivalTime;\r\n    this.basePrice = props.basePrice;\r\n    this.pricePerPassenger = props.pricePerPassenger;\r\n    this.currency = props.currency;\r\n    this.createdAt = props.createdAt;\r\n  }\r\n\r\n  public static create(props: {\r\n    driverId: string;\r\n    vehicleType: VehicleType;\r\n    mode: TravelMode;\r\n    originCity: string;\r\n    originAddress: string;\r\n    destCity: string;\r\n    destAddress: string;\r\n    stationOrigin?: string;\r\n    stationDest?: string;\r\n    departureTime: Date;\r\n    basePrice: number;\r\n    currency: string;\r\n  }): Trip {\r\n    const estimatedArrivalTime = new Date(props.departureTime.getTime() + 2 * 60 * 60 * 1000); // +2 hours\r\n    \r\n    return new Trip({\r\n      id: crypto.randomUUID(),\r\n      ...props,\r\n      status: 'SCHEDULED',\r\n      passengers: [],\r\n      estimatedArrivalTime,\r\n      pricePerPassenger: props.basePrice,\r\n      createdAt: new Date(),\r\n    });\r\n  }\r\n\r\n  public static fromPrimitives(props: TripProps): Trip {\r\n    return new Trip(props);\r\n  }\r\n\r\n  public toPrimitives(): TripProps {\r\n    return {\r\n      id: this.id,\r\n      driverId: this.driverId,\r\n      vehicleType: this.vehicleType,\r\n      mode: this.mode,\r\n      status: this.status,\r\n      passengers: this.passengers,\r\n      originCity: this.originCity,\r\n      originAddress: this.originAddress,\r\n      destCity: this.destCity,\r\n      destAddress: this.destAddress,\r\n      stationOrigin: this.stationOrigin,\r\n      stationDest: this.stationDest,\r\n      departureTime: this.departureTime,\r\n      estimatedArrivalTime: this.estimatedArrivalTime,\r\n      basePrice: this.basePrice,\r\n      pricePerPassenger: this.pricePerPassenger,\r\n      currency: this.currency,\r\n      createdAt: this.createdAt,\r\n    };\r\n  }\r\n\r\n  getMaxCapacity(): number {\r\n    return this.vehicleType === 'VAN' ? 7 : 3;\r\n  }\r\n\r\n  getAvailableSeats(): number {\r\n    return this.getMaxCapacity() - this.passengers.length;\r\n  }\r\n\r\n  addPassenger(passenger: Omit<TripPassenger, 'pricePaid' | 'currency'>): void {\r\n    if (this.getAvailableSeats() <= 0) {\r\n      throw new Error('No seats available.');\r\n    }\r\n\r\n    if (this.vehicleType === 'SUV' && passenger.frontSeat && this.passengers.some(p => p.frontSeat)) {\r\n      throw new Error('Only one passenger can have the front seat in SUV.');\r\n    }\r\n\r\n    this.passengers.push({\r\n      ...passenger,\r\n      pricePaid: this.pricePerPassenger,\r\n      currency: this.currency,\r\n    });\r\n\r\n    if (this.passengers.length > 1) {\r\n      this.recalculatePricePerPassenger();\r\n    }\r\n\r\n    if (this.getAvailableSeats() === 0) {\r\n      this.status = 'WAITING_PASSENGERS';\r\n    }\r\n  }\r\n\r\n  private recalculatePricePerPassenger(): void {\r\n    const shareDiscount = this.passengers.length === 2 ? 0.6 : this.passengers.length === 3 ? 0.45 : 1.0;\r\n    this.pricePerPassenger = this.basePrice * shareDiscount;\r\n    \r\n    for (const p of this.passengers) {\r\n      p.pricePaid = this.pricePerPassenger;\r\n    }\r\n  }\r\n\r\n  assignDriver(driverId: string): void {\r\n    if (this.status !== 'SCHEDULED') {\r\n      throw new Error('Cannot assign driver to a trip that is not scheduled.');\r\n    }\r\n    this.driverId = driverId;\r\n  }\r\n\r\n  start(): void {\r\n    if (this.status !== 'SCHEDULED' && this.status !== 'WAITING_PASSENGERS') {\r\n      throw new Error('Cannot start trip in current state.');\r\n    }\r\n    this.status = 'IN_TRANSIT';\r\n  }\r\n\r\n  complete(): void {\r\n    if (this.status !== 'IN_TRANSIT') {\r\n      throw new Error('Only in-transit trips can be completed.');\r\n    }\r\n    this.status = 'COMPLETED';\r\n  }\r\n\r\n  cancel(): void {\r\n    if (this.status === 'COMPLETED' || this.status === 'CANCELLED') {\r\n      throw new Error('Cannot cancel completed or already cancelled trip.');\r\n    }\r\n    this.status = 'CANCELLED';\r\n  }\r\n}","import { Trip } from '../entities/trip.entity';\r\nimport { UUID, Location } from '@going-monorepo-clean/shared-domain';\r\n\r\nexport const ITripRepository = Symbol('ITripRepository');\r\n\r\nexport interface ITripRepository {\r\n  save(trip: Trip): Promise<void>;\r\n  findById(id: UUID): Promise<Trip | null>;\r\n  findAvailableSharedTrips(origen: Location, destino: Location, tipoVehiculo: 'SUV' | 'VAN'): Promise<Trip[]>;\r\n  findTripsByDriverId(driverId: string): Promise<Trip[]>;\r\n  update(trip: Trip): Promise<void>;\r\n}","// Transport Core Domain\r\nexport * from './libs/entities/trip.entity';\r\nexport * from './libs/ports/itrip.repository';","import { Injectable } from '@nestjs/common';\r\nimport { PrismaService } from '@going-monorepo-clean/prisma-client';\r\nimport { ITripRepository, Trip, TripStatus, VehicleType, TravelMode } from '@going-monorepo-clean/domains-transport-core';\r\nimport { UUID, Location } from '@going-monorepo-clean/shared-domain';\r\n\r\n@Injectable()\r\nexport class PrismaTransportRepository implements ITripRepository {\r\n  constructor(private readonly prisma: PrismaService) {}\r\n\r\n  async save(trip: Trip): Promise<void> {\r\n    const primitives = trip.toPrimitives();\r\n    \r\n    await this.prisma.transport.upsert({\r\n      where: { id: primitives.id },\r\n      create: {\r\n        id: primitives.id,\r\n        driverId: primitives.driverId,\r\n        vehicleType: primitives.vehicleType,\r\n        mode: primitives.mode,\r\n        licensePlate: 'PENDING', // Default, can be updated later\r\n        capacity: trip.getMaxCapacity(),\r\n        pricePerKm: primitives.basePrice,\r\n        pricePerPassenger: primitives.pricePerPassenger,\r\n        currency: primitives.currency,\r\n        status: primitives.status.toUpperCase() as any, // Cast to any to avoid Enum mismatch during build\r\n        originCity: primitives.originCity,\r\n        originAddress: primitives.originAddress,\r\n        destCity: primitives.destCity,\r\n        destAddress: primitives.destAddress,\r\n        stationOrigin: primitives.stationOrigin,\r\n        stationDest: primitives.stationDest,\r\n        departureTime: primitives.departureTime,\r\n        arrivalTime: primitives.estimatedArrivalTime,\r\n        passengers: primitives.passengers as any,\r\n      },\r\n      update: {\r\n        status: primitives.status.toUpperCase() as any,\r\n        pricePerKm: primitives.basePrice,\r\n        pricePerPassenger: primitives.pricePerPassenger,\r\n        departureTime: primitives.departureTime,\r\n        arrivalTime: primitives.estimatedArrivalTime,\r\n        originCity: primitives.originCity,\r\n        originAddress: primitives.originAddress,\r\n        destCity: primitives.destCity,\r\n        destAddress: primitives.destAddress,\r\n        stationOrigin: primitives.stationOrigin,\r\n        stationDest: primitives.stationDest,\r\n        passengers: primitives.passengers as any,\r\n      },\r\n    });\r\n  }\r\n\r\n  async findById(id: UUID): Promise<Trip | null> {\r\n    const record = await this.prisma.transport.findUnique({\r\n      where: { id: id },\r\n    });\r\n\r\n    if (!record) return null;\r\n\r\n    return this.toDomain(record);\r\n  }\r\n\r\n  async findAvailableSharedTrips(origin: Location, dest: Location, vehicleType: 'SUV' | 'VAN'): Promise<Trip[]> {\r\n    const records = await this.prisma.transport.findMany({\r\n      where: {\r\n        status: 'SCHEDULED' as any,\r\n        vehicleType: vehicleType,\r\n        originCity: origin.city,\r\n        destCity: dest.city,\r\n      },\r\n    });\r\n\r\n    return records.map(r => this.toDomain(r));\r\n  }\r\n\r\n  async findTripsByDriverId(driverId: string): Promise<Trip[]> {\r\n    const records = await this.prisma.transport.findMany({\r\n      where: { driverId },\r\n    });\r\n\r\n    return records.map(r => this.toDomain(r));\r\n  }\r\n\r\n  async update(trip: Trip): Promise<void> {\r\n    await this.save(trip);\r\n  }\r\n\r\n  private toDomain(record: any): Trip {\r\n    // Parse passengers from JSON\r\n    const passengers = Array.isArray(record.passengers) \r\n      ? record.passengers \r\n      : (typeof record.passengers === 'string' ? JSON.parse(record.passengers) : []);\r\n\r\n    return Trip.fromPrimitives({\r\n      id: record.id,\r\n      driverId: record.driverId,\r\n      vehicleType: record.vehicleType as VehicleType,\r\n      mode: record.mode as TravelMode,\r\n      status: (record.status as string).toLowerCase() as any,\r\n      passengers: passengers,\r\n      originCity: record.originCity,\r\n      originAddress: record.originAddress,\r\n      destCity: record.destCity,\r\n      destAddress: record.destAddress,\r\n      stationOrigin: record.stationOrigin,\r\n      stationDest: record.stationDest,\r\n      departureTime: new Date(record.departureTime),\r\n      estimatedArrivalTime: new Date(record.arrivalTime),\r\n      basePrice: Number(record.pricePerKm),\r\n      pricePerPassenger: Number(record.pricePerPassenger),\r\n      currency: record.currency,\r\n      createdAt: record.createdAt,\r\n    });\r\n  }\r\n}\r\n","import { Module, Global } from '@nestjs/common';\r\nimport { ConfigModule } from '@nestjs/config';\r\n\r\n// Shared Prisma Module\r\nimport { PrismaModule, PrismaService } from '@going-monorepo-clean/prisma-client';\r\n\r\n// Domain Ports\r\nimport { ITripRepository } from '@going-monorepo-clean/domains-transport-core';\r\n\r\n// Repository Implementation\r\nimport { PrismaTransportRepository } from './persistence/prisma-transport.repository';\r\n\r\n@Global()\r\n@Module({\r\n  imports: [\r\n    ConfigModule.forRoot({ isGlobal: true }),\r\n    PrismaModule,\r\n  ],\r\n  providers: [\r\n    {\r\n      provide: ITripRepository,\r\n      useClass: PrismaTransportRepository,\r\n    },\r\n    PrismaTransportRepository,\r\n  ],\r\n  exports: [ITripRepository, PrismaTransportRepository],\r\n})\r\nexport class InfrastructureModule {}","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"class-transformer\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"class-validator\");","import { Type } from 'class-transformer';\r\nimport {\r\n  IsNotEmpty,\r\n  IsString,\r\n  IsNumber,\r\n  Min,\r\n  ValidateNested,\r\n  IsUUID,\r\n  IsIn,\r\n  IsLatitude,\r\n  IsLongitude,\r\n  IsOptional,\r\n  IsDateString,\r\n} from 'class-validator';\r\n\r\nclass PriceDto {\r\n  @IsNotEmpty()\r\n  @IsNumber()\r\n  @Min(0)\r\n  amount: number;\r\n\r\n  @IsNotEmpty()\r\n  @IsIn(['USD'])\r\n  currency: 'USD';\r\n}\r\n\r\nclass LocationDto {\r\n  @IsNotEmpty()\r\n  @IsString()\r\n  city: string;\r\n\r\n  @IsNotEmpty()\r\n  @IsString()\r\n  address: string;\r\n  \r\n  @IsNotEmpty()\r\n  @IsLatitude()\r\n  latitude: number;\r\n\r\n  @IsNotEmpty()\r\n  @IsLongitude()\r\n  longitude: number;\r\n}\r\n\r\nexport class RequestTripDto {\r\n  @IsNotEmpty()\r\n  @IsUUID()\r\n  userId: string;\r\n\r\n  @IsOptional()\r\n  @IsUUID()\r\n  driverId?: string;\r\n\r\n  @IsOptional()\r\n  @IsIn(['SUV', 'VAN'])\r\n  vehicleType?: string;\r\n\r\n  @IsOptional()\r\n  @IsIn(['DOOR_TO_DOOR', 'POINT_TO_POINT'])\r\n  mode?: string;\r\n\r\n  @IsNotEmpty()\r\n  @IsDateString()\r\n  departureTime: string;\r\n\r\n  @IsNotEmpty()\r\n  @ValidateNested()\r\n  @Type(() => LocationDto)\r\n  origin: LocationDto;\r\n\r\n  @IsNotEmpty()\r\n  @ValidateNested()\r\n  @Type(() => LocationDto)\r\n  destination: LocationDto;\r\n\r\n  @IsNotEmpty()\r\n  @ValidateNested()\r\n  @Type(() => PriceDto)\r\n  price: PriceDto;\r\n}","import { Inject, Injectable } from '@nestjs/common';\r\nimport {\r\n  Trip,\r\n  ITripRepository,\r\n  VehicleType,\r\n  TravelMode,\r\n} from '@going-monorepo-clean/domains-transport-core';\r\nimport { RequestTripDto } from '../dto/request-trip.dto';\r\n\r\n@Injectable()\r\nexport class RequestTripUseCase {\r\n  constructor(\r\n    @Inject(ITripRepository)\r\n    private readonly tripRepo: ITripRepository,\r\n  ) {}\r\n\r\n  async execute(dto: RequestTripDto): Promise<{ id: string }> {\r\n    // Assuming DTO has necessary fields, mapping them to entity creation\r\n    // Note: The DTO might need updates to match new Trip entity props\r\n    \r\n    const trip = Trip.create({\r\n      driverId: dto.driverId || 'PENDING', // Needs logic\r\n      vehicleType: (dto.vehicleType as VehicleType) || 'SUV',\r\n      mode: (dto.mode as TravelMode) || 'POINT_TO_POINT',\r\n      originCity: dto.origin.city,\r\n      originAddress: dto.origin.address,\r\n      destCity: dto.destination.city,\r\n      destAddress: dto.destination.address,\r\n      departureTime: new Date(dto.departureTime),\r\n      basePrice: dto.price.amount,\r\n      currency: dto.price.currency,\r\n    });\r\n\r\n    await this.tripRepo.save(trip);\r\n\r\n    return { id: trip.id };\r\n  }\r\n}","import { Inject, Injectable, InternalServerErrorException, NotFoundException, PreconditionFailedException } from '@nestjs/common';\r\nimport { ITripRepository } from '@going-monorepo-clean/domains-transport-core';\r\nimport { UUID } from '@going-monorepo-clean/shared-domain';\r\n\r\n@Injectable()\r\nexport class AcceptTripUseCase {\r\n  constructor(\r\n    @Inject(ITripRepository)\r\n    private readonly tripRepo: ITripRepository,\r\n  ) {}\r\n\r\n  async execute(tripId: UUID, driverId: UUID): Promise<void> {\r\n    try {\r\n      // UUID is string alias, so use it directly\r\n      const trip = await this.tripRepo.findById(tripId);\r\n      \r\n      if (!trip) {\r\n        throw new NotFoundException(`Trip with id ${tripId} not found`);\r\n      }\r\n\r\n      try {\r\n        trip.assignDriver(driverId);\r\n      } catch (error) {\r\n        throw new PreconditionFailedException(error.message);\r\n      }\r\n\r\n      await this.tripRepo.update(trip);\r\n    } catch (error) {\r\n      if (error instanceof NotFoundException || error instanceof PreconditionFailedException) {\r\n        throw error;\r\n      }\r\n      throw new InternalServerErrorException(error.message);\r\n    }\r\n  }\r\n}","import { Module } from '@nestjs/common';\r\nimport { AcceptTripUseCase } from './use-cases/accept-trip.use-case';\r\nimport { RequestTripUseCase } from './use-cases/request-trip.use-case';\r\n// Import other use cases if needed\r\n\r\n@Module({\r\n  providers: [\r\n    AcceptTripUseCase,\r\n    RequestTripUseCase,\r\n  ],\r\n  exports: [\r\n    AcceptTripUseCase,\r\n    RequestTripUseCase,\r\n  ],\r\n})\r\nexport class TransportApplicationModule {}\r\n","export * from './lib/dto/request-trip.dto';\r\nexport * from './lib/use-cases/request-trip.use-case';\r\nexport * from './lib/use-cases/accept-trip.use-case';\r\nexport * from './lib/transport-application.module';","import { Body, Controller, Post, Param, Patch } from '@nestjs/common';\r\nimport { RequestTripUseCase, AcceptTripUseCase, RequestTripDto } from '@going-monorepo-clean/domains-transport-application';\r\nimport { UUID } from '@going-monorepo-clean/shared-domain';\r\n\r\n@Controller('transport')\r\nexport class TransportController {\r\n  constructor(\r\n    private readonly requestTripUseCase: RequestTripUseCase,\r\n    private readonly acceptTripUseCase: AcceptTripUseCase,\r\n  ) {}\r\n\r\n  @Post('request')\r\n  async requestTrip(@Body() dto: RequestTripDto) {\r\n    return this.requestTripUseCase.execute(dto);\r\n  }\r\n\r\n  @Patch(':id/accept')\r\n  async acceptTrip(\r\n    @Param('id') id: string,\r\n    @Body('driverId') driverId: string\r\n  ) {\r\n    // Assuming UUID validation happens in VO or Pipe, but here we cast string to UUID type alias\r\n    // In a real scenario, we might want a DTO for the body or a ParseUUIDPipe\r\n    return this.acceptTripUseCase.execute(id as UUID, driverId as UUID);\r\n  }\r\n}","import { Module } from '@nestjs/common';\r\nimport { ConfigModule } from '@nestjs/config';\r\nimport { InfrastructureModule } from './infrastructure/infrastructure.module';\r\nimport { TransportApplicationModule } from '@going-monorepo-clean/domains-transport-application';\r\nimport { TransportController } from './api/transport.controller';\r\n\r\n@Module({\r\n  imports: [\r\n    ConfigModule.forRoot({ isGlobal: true }),\r\n    InfrastructureModule,\r\n    TransportApplicationModule,\r\n  ],\r\n  controllers: [TransportController],\r\n  providers: [],\r\n})\r\nexport class AppModule {}","import { NestFactory } from '@nestjs/core';\r\nimport { AppModule } from './app.module';\r\nimport { Logger, ValidationPipe } from '@nestjs/common';\r\n\r\nasync function bootstrap() {\r\n  const app = await NestFactory.create(AppModule);\r\n  const port = process.env.PORT || 3006;\r\n  \r\n  app.enableCors();\r\n  app.setGlobalPrefix('api');\r\n  \r\n  app.useGlobalPipes(new ValidationPipe({ whitelist: true, transform: true }));\r\n  await app.listen(port);\r\n  Logger.log(\r\n    `ðŸš€ Transport-Service estÃ¡ corriendo en http://localhost:${port}/api`,\r\n    'Bootstrap',\r\n  );\r\n}\r\nbootstrap();\r\n"],"names":[],"ignoreList":[],"sourceRoot":""}